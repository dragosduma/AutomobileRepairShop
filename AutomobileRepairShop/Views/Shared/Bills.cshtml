@model List<AutomobileRepairShop.Models.CarPart>

@{
    <!DOCTYPE html>
    <html>
    <head>
        <link rel="stylesheet"
              href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/css/jquery.dataTables.min.css"
              integrity="sha512-1k7mWiTNoyx2XtmI96o+hdjP8nn0f3Z2N4oF/9ZZRgijyV4omsKOXEnqL1gKQNPy2MTSP9rIEWGcH/CInulptA=="
              crossorigin="anonymous"
              referrerpolicy="no-referrer" />
    </head>
    <body>
        <div class="container-fluid">
            <table class="table table-striped table-hover" id="myTable">
                <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">DepartmentID</th>
                        <th scope="col">Name</th>
                        <th scope="col">Price</th>
                        <th scope="col">Labour Description</th>
                        <th scope="col">Labour Price</th>
                        <th scope="col">Add to Bill</th>
                    </tr>
                </thead>
                <tbody id="partTable">
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>@Html.DisplayFor(modelItem => item.Id)</td>
                            <td>@Html.DisplayFor(modelItem => item.DepartmentId)</td>
                            <td>@Html.DisplayFor(modelItem => item.Name)</td>
                            <td>$@Html.DisplayFor(modelItem => item.Price)</td>
                            <td>@Html.DisplayFor(modelItem => item.LaborName)</td>
                            <td>$@Html.DisplayFor(modelItem => item.LaborPrice)</td>
                            <td><button type="button" class="btn btn-outline-info" itemid="@item.Id" id="btnAddToCart" >Add</button></td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"
                integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg=="
                crossorigin="anonymous"
                referrerpolicy="no-referrer"
                defer>
                </script>

        <script>
            $(document).ready(function() {
                $('#myTable').DataTable();
            } );
        </script>
        <script >
            $('.btn').click(function(){
                var itemId=$(this).attr('itemid');
                var formData=new FormData();
                formData.append("ItemId",itemId);

                $.ajax({
                    async: true,
                    type: 'POST',
                    contentType: false,
                    processData: false,
                    data: formData,
                    url: '/Employee/Bills',
                    success: function(data) {
                        if(data.success){
                            $("#cartItem").text("Cart("+data.Counter+")");
                        }
                    },
                    error: function() {
                        alert("There is some problem.");
                    }
                });
            });
        </script>
    </body>
    </html>
}
