@* @ @model List<AutomobileRepairShop.Models.CarPart> *@
@model dynamic
@{
    <!DOCTYPE html>
    <html>
    <head>
        <link rel="stylesheet"
              href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/css/jquery.dataTables.min.css"
              integrity="sha512-1k7mWiTNoyx2XtmI96o+hdjP8nn0f3Z2N4oF/9ZZRgijyV4omsKOXEnqL1gKQNPy2MTSP9rIEWGcH/CInulptA=="
              crossorigin="anonymous"
              referrerpolicy="no-referrer" />
    </head>
    <body>
        <div class="container-fluid">
            <table class="table table-striped table-hover" id="myTable">
                <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">DepartmentID</th>
                        <th scope="col">Name</th>
                        <th scope="col">Price</th>
                        <th scope="col">Labour Description</th>
                        <th scope="col">Labour Price</th>
                        <th scope="col">Add to Bill</th>
                    </tr>
                </thead>
                <tbody id="partTable">
                    @foreach (CarPart item in Model.CarParts)
                    {
                        <tr>
                            <td>@Html.DisplayFor(modelItem => item.Id)</td>
                            <td>@Html.DisplayFor(modelItem => item.DepartmentId)</td>
                            <td>@Html.DisplayFor(modelItem => item.Name)</td>
                            <td>$@Html.DisplayFor(modelItem => item.Price)</td>
                            <td>@Html.DisplayFor(modelItem => item.LaborName)</td>
                            <td>$@Html.DisplayFor(modelItem => item.LaborPrice)</td>
                            <td><button type="button" class="btn btn-outline-info" itemid="@item.Id" itemdepart="@item.DepartmentId" itemname="@item.Name" itemprice="@item.Price" itemlaborname="@item.LaborName" itemlaborprice="@item.LaborPrice">Add</button></td>
                        </tr>
                    }
                </tbody>
        </div>
         
        <div class="container-fluid">
            <table class="table table-striped table-hover" id="myTable1">
                <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">DepartmentID</th>
                        <th scope="col">Name</th>
                        <th scope="col">Price</th>
                        <th scope="col">Labour Description</th>
                        <th scope="col">Labour Price</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody id="partTable1">
                    @foreach (CarPart item in Model.AddedCarParts)
                    {
                        <tr>
                            <td>@Html.DisplayFor(modelItem => item.Id)</td>
                            <td>@Html.DisplayFor(modelItem => item.DepartmentId)</td>
                            <td>@Html.DisplayFor(modelItem => item.Name)</td>
                            <td>$@Html.DisplayFor(modelItem => item.Price)</td>
                            <td>@Html.DisplayFor(modelItem => item.LaborName)</td>
                            <td>$@Html.DisplayFor(modelItem => item.LaborPrice)</td>
                            <td></td>
                        </tr>
                    }
                </tbody>
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"
                integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg=="
                crossorigin="anonymous"
                referrerpolicy="no-referrer"
                defer>
                </script>

        <script>
            $(document).ready(function() {
                $('#myTable').DataTable();
            } );
        </script>
        <script >
            var list=[];
            $('.btn').click(function(){
                var itemId={Id: parseInt($(this).attr('itemid'))};
                //var itemId=$(this).attr('itemid');
                //list.push(parseInt(itemId));
                list.push(itemId);
                var dataToPost=JSON.stringify(list);
                //console.log(list);
                //console.log(dataToPost);
                $.ajax({
                    async: true,
                    type: 'POST',
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    data: dataToPost,
                    url: '/Employee/BillsAdd',
                    success: function(data) {
                        if(data.success){

                        };
                    },
                    error: function() {
                        alert("There is some problem.");
                    }
                });
                var table=document.getElementById("myTable1");
                
			    var row = table.insertRow(1);

                var cell = $(row.insertCell(0));
                cell.append($(this).attr('itemid'));

                cell = $(row.insertCell(1));
                cell.append($(this).attr('itemdepart'));

                cell = $(row.insertCell(2));
                cell.append($(this).attr('itemname'));

                cell = $(row.insertCell(3));
                cell.append($(this).attr('itemprice'));

                cell = $(row.insertCell(4));
                cell.append($(this).attr('itemlaborname'));

                cell = $(row.insertCell(5));
                cell.append($(this).attr('itemlaborprice'));

            });
            function createbillfunction(){
                if(list.length<1){
                    alert("null");
                }else 
                {
                    var dataToPost=JSON.stringify(list);
                    $.ajax({
                        async: true,
                        type: 'POST',
                        dataType: "json",
                        contentType: "application/json; charset=utf-8",
                        data: dataToPost,
                        url: '/Employee/CreateBills',
                    });
                }
            }
        </script>
        <button type="button" onclick="createbillfunction()">Create bill</button>
    </body>
    </html>
}
